# Zip Slip
Zip Slip is a widespread arbitrary file overwrite critical vulnerability discovered and responsibly disclosed by the Snyk Security team ahead of a public disclosure on 5th June 2018. It affects thousands of projects, most notably Apache Maven, Hadoop, Pivotal and many more. The vulnerability has been found in ecosystems, including JavaScript, Ruby, .NET and Go, but is especially prevalent in Java, where there is no central library offering high level processing of archive (e.g. zip) files. The lack of such a library led to vulnerable code snippets being hand crafted and shared among developer communities such as StackOverflow. The vulnerability is exploited using a specially crafted archive that holds path traversal filenames (e.g. ../../evil.sh). The Zip Slip vulnerability can affect numerous archives formats, including tar, jar, war, cpio, apk, rar and 7z.

Zip Slip is a form of directory traversal that can be exploited by extracting files from an archive. The premise of the directory traversal vulnerability is that an attacker can gain access to parts of the file system outside of the target folder in which they should reside. This could happen on both the server side or client side and can lead to sensitive files being written, or overwritten. If an executable is overwritten with a file containing malicious code, the problem can turn into an arbitrary code execution issue. If configuration files or SSH keys are overwritten, it will also be a remote code execution issue.

<TODO: Vulnerable code example>


## Affected Libraries

<TODO:>
<List of affected libraries, some are vulnerable, some are lacking high level api, resulting in vulnerable implementations being reused>


| Vendor        | Product                  | Language   | Confirmed vulnerable | Fixed Version     | CVE              | Fixed     |                                                                                                                                                                                                                                                    |
|---------------|--------------------------|------------|----------------------|-------------------|------------------|-----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| npm library   | [unzipper](https://github.com/ZJONSSON/node-unzipper)                 | JavaScript | YES                  | 0.8.13            | CVE-2018-1002203 | 17/4/2018 | https://github.com/ZJONSSON/node-unzipper/pull/59                                                                                                                                                                                                  |
| npm library   | [adm-zip](https://github.com/cthackers/adm-zip)                  | JavaScript | YES                  | 0.4.9             | CVE-2018-1002204 | 23/4/2018 | https://github.com/cthackers/adm-zip/pull/212                                                                                                                                                                                                      |
| Maven library | [codehaus/plexus-archiver](https://github.com/codehaus-plexus/plexus-archiver) | Java       | YES                  | 3.6.0             | CVE-2018-1002200 | 6/5/2018  | https://github.com/codehaus-plexus/plexus-archiver/pull/87                                                                                                                                                                                         |
| Maven library | [zeroturnaround/zt-zip](https://github.com/zeroturnaround/zt-zip)    | Java       | YES                  | 1.13              | CVE-2018-1002201 | 26/4/2018 | https://github.com/zeroturnaround/zt-zip/blob/master/src/main/java/org/zeroturnaround/zip/ZipUtil.java#L389:26                                                                                                                                     |
| Maven library | [zip4j](https://github.com/supasate/zip4j)                    | Java       | YES                  |                   | CVE-2018-1002202 |           | https://github.com/supasate/zip4j                                                                                                                                                                                                                  |
| Nuget library | [DotNetZip.Semverd](https://github.com/haf/DotNetZip.Semverd)        | .NET       | YES                  | 1.11.0            | CVE-2018-1002205 | 7/5/2018  | https://github.com/haf/DotNetZip.Semverd/compare/master...shana:bugs/relative-paths?expand=1                                                                                                                                                       |
| Nuget library | [SharpCompress](https://github.com/adamhathcock/sharpcompress)            | .NET       | YES                  | 0.21.0            | CVE-2018-1002206 | 2/5/2018  | https://github.com/adamhathcock/sharpcompress/blob/2a5494a804dd3d6f5bec1ec79a52d54ffce610f5/src/SharpCompress/Archives/IArchiveEntryExtensions.cs#L58-L67                                                                                          |
| Go library    | [mholt/archiver](https://github.com/mholt/archiver)           | Go         | YES                  | e4ef56d4          | CVE-2018-1002207 | 17/4/2018 | https://github.com/mholt/archiver/pull/65                                                                                                                                                                                                          |
| Oracle        | [java.util.zip](https://docs.oracle.com/javase/8/docs/api/index.html?java/util/zip/package-summary.html)            | Java       | * No High Level API  | Documentation Fix | N/A              |           |                                                                                                                                                                                                                                                    |
| Apache        | [commons-compress](https://github.com/apache/commons-compress/)         | Java       | * No High Level API  | Documentation Fix | N/A              | 23/4/2018 | https://github.com/apache/commons-compress/commit/97867f6fa3634c77dfafd76c89ecb1087f5cd1ae#diff-1d31ec0d64a29d487ff7377fd8d20cddR359                                                                                                               |
| Nuget library | [SharpZipLib](https://github.com/icsharpcode/SharpZipLib)              | .NET       | * No High Level API  |                   | N/A              |           | https://github.com/icsharpcode/SharpZipLib/blob/master/samples/ICSharpCode.SharpZipLib.Samples/cs/unzipfile/UnZipFile.cs#L37https://github.com/icsharpcode/SharpZipLib/wiki/Zip-Samples#download-and-unpack-a-zip-from-an-ftp-server-with-recovery |
| Ruby gem      | [zip-ruby](https://bitbucket.org/winebarrel/zip-ruby/src/a0bceebd7bf031c8815a8359ba9befe6ead1bedc/zipruby/?at=default                      )                 | Ruby       | * No High Level API  |                   | N/A              |           |                                                                                                                    |
| Ruby gem      | [rubyzip](https://github.com/rubyzip/rubyzip)                  | Ruby       | * No High Level API  |                   | N/A              |           |                                                                                                                                                                                                                  |
| Ruby gem      | [zipruby](https://github.com/fjg/zipruby)                  | Ruby       | * No High Level API  |                   | N/A              |           |                                                                                                                                                                                                                      |
| Go library    | [archive](https://golang.org/pkg/archive/)                  | Go         | * No High Level API  |                   | N/A              |           |                                                                                                                                                                                                                     |

## Projects Affected and Fixed 
<TODO: >

| Vendor              | Product                           | Fixed date | Fixed version | CVE           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Comment                                                                                                                                                                |
|---------------------|-----------------------------------|------------|---------------|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Apache Storm        | Storm                             | 2/5/2018   | 1.0.7         | CVE-2018-8008 | https://github.com/apache/storm/blob/master/storm-server/src/main/java/org/apache/storm/utils/ServerUtils.java#L389https://github.com/apache/storm/blob/master/storm-server/src/main/java/org/apache/storm/utils/ServerUtils.java#L523https://github.com/apache/storm/blob/master/storm-server/src/main/java/org/apache/storm/utils/ServerUtils.java#L592https://github.com/apache/storm/blob/master/storm-server/src/main/java/org/apache/storm/utils/ServerUtils.java#L650 | https://github.com/apache/storm/commit/1117a37b01a1058897a34e11ff5156e465efb692                                                                                        |
| Apache Hadoop       | Hadoop                            | 23/5/2018  |               | CVE-2018-8009 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | https://github.com/apache/hadoop/commit/745f203e577bacb35b042206db94615141fa5e6f#diff-19cfa944d1bb9ce1daa46aa4223f3642                                                 |
| Apache Hive         | Hive                              |            |               | CVE-2018-8009 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                        |
| Apache              | Maven                             |            |               |               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                        |
| Apache              | Ant                               | 21/4/2018  | 1.9.12        |               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | https://github.com/apache/ant/commit/e56e54565804991c62ec76dad385d2bdda8972a7#diff-32b057b8e95fa2b3f7d644552643010aR11                                                 |
| Pivotal             | spring-integration-zip            |            | 1.0.1         | CVE-2018-1261 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | https://github.com/spring-projects/spring-integration-extensions/commit/a5573eb232ff85199ff9bb28993df715d9a19a25                                                       |
| Pivotal             | spring-integration-zip            | 10/5/2018  | 1.0.2         | CVE-2018-1263 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | https://github.com/spring-projects/spring-integration-extensions/commit/d10f537283d90eabd28af57ac97f860a3913bf9b                                                       |
| HP                  | Fortify Cloud Scan Jenkins Plugin | 27/4/2018  |               |               | https://github.com/jenkinsci/fortify-cloudscan-plugin/blob/cfa6d392abd900ce60a08bb830f99e821361b238/src/main/java/org/jenkinsci/plugins/fortifycloudscan/util/ArchiveUtil.java#L33:24                                                                                                                                                                                                                                                                                        | https://github.com/jenkinsci/fortify-cloudscan-plugin/commit/15a5270734280558f9356bd8681303b37f44f020#diff-443258e63dbf581491b1104125a59fd4                            |
| OWASP               | DependencyCheck                   |            |               |               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | https://github.com/jeremylong/DependencyCheck/blob/3b294282f346b01302cde09cbc7439077205fb03/core/src/main/java/org/owasp/dependencycheck/utils/ExtractionUtil.java#L96 |
| Amazon              | AWS Toolkit for Eclipse           | 31/5/2018  |               |               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | https://github.com/aws/aws-toolkit-eclipse/commit/f2bd33e11299456979dc2092813a09e716f3d355                                                                             |
| SonarCube           | SonarCube                         |            |               |               | https://github.com/SonarSource/sonarqube/blob/c0d2705e610d771b8c66ef22e64530c7bca4f538/sonar-plugin-api/src/main/java/org/sonar/api/utils/ZipUtils.java#L148                                                                                                                                                                                                                                                                                                                 | https://github.com/SonarSource/sonarqube/commit/08438a2c47112f2fce1e512f6c843c908abed4c7#diff-6d8def68a00bf88a105528765f02fb95                                         |
| Cinchapi            | Concourse                         |            |               |               | https://github.com/cinchapi/concourse/blob/a890d80a80298436995b42045474c6f01b53066b/concourse-driver-java/src/main/java/com/cinchapi/concourse/util/ZipFiles.java#L100                                                                                                                                                                                                                                                                                                       | https://github.com/cinchapi/concourse/commit/9db7123029d103abaa909abd737876df7ace9957                                                                                  |
| Orient Technologies | OrientDB                          |            |               |               | https://github.com/orientechnologies/orientdb/blob/1c184f1295d1ce1538e5debac05addc7ca69b5b8/core/src/main/java/com/orientechnologies/orient/core/compression/impl/OZIPCompressionUtil.java#L87+https://github.com/orientechnologies/orientdb/blob/5684b63f6efb03d407d0175b9eab616b36bbecbd/etl/src/main/java/com/orientechnologies/orient/etl/util/OFileManager.java#L76                                                                                                     | https://github.com/orientechnologies/orientdb/commit/1dd754996682b5a7f467072b34747a33642d983b                                                                          |
| FenixEdu            | Academic                          |            |               |               | https://github.com/FenixEdu/fenixedu-academic/blob/674a7081d6a28cfadcae1cf732c11e9599cdedee/src/main/java/org/fenixedu/academic/util/FileUtils.java#L118                                                                                                                                                                                                                                                                                                                     | https://github.com/FenixEdu/fenixedu-academic/commit/a64a568de3d3dd65338320239ecc7d6d94f3b36d                                                                          |
| eXist-db            | [exist](https://github.com/eXist-db/exist/)                          |            |               |               | https://github.com/eXist-db/exist/pull/1897                                                                                                                                                                                                                                                                                                                     | https://github.com/FenixEdu/fenixedu-academic/commit/a64a568de3d3dd65338320239ecc7d6d94f3b36d                                                                          
|                     |                                   |            |               |               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                        |



## Defensively fixed but deemed not exploitable
<TODO: Projects that were confirmed by the maintainer to be not vulnerable, but the vulnerable implementation was fixed or removed to prevent future use or spreading of the code>

| Vendor          | Product            | Vulnerable Code Removed                                                                                                                      | Vulnerable Code                                                                                                                                                                                                                                                                                    |
|-----------------|--------------------|----------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Apache          | Kylin              | 24/4/2018                                                                                                                                    | https://github.com/apache/kylin/blob/master/storage-hbase/src/main/java/org/apache/kylin/storage/hbase/util/TarGZUtil.java#L43                                                                                                                                                                     |
| Apache          | NiFi               | 24/4/2018                                                                                                                                    | https://github.com/apache/nifi/blob/master/nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/UnpackContent.java#L312                                                                                                                |
| Apache          | Geode              | [20/4/2018](https://github.com/apache/geode/commit/09ddd563fc2c2cbe605314bccc7b94f9db8b1de5)                                                 |                                                                                                                                                                                                                                                                                                    |
| Jenkins         | Jenkins CI         | [5/5/2018](https://github.com/jenkinsci/jenkins/pull/3402)                                                                                   | https://github.com/jenkinsci/jenkins/pull/3402                                                                                                                                                                                                                                                     |
| Elastic         | ElasticSearch      | [10/5/2018](https://github.com/elastic/elasticsearch/commit/bf2365d13b2e26e45a47fbc4f53818a16579f80c#diff-7e3dde64df2d4f7290d743c8fb376213)  | https://github.com/elastic/elasticsearch/blob/ee802ad63c0f21d697a5095dd05dc6f94626ee4d/test/framework/src/main/java/org/elasticsearch/common/io/FileTestUtils.java#L68-L94                                                                                                                         |
| LinkedIn        | Pinot              | [22/5/2018](https://github.com/linkedin/pinot/commit/07b0508f16f5e8e1bcd52963c82dbdf15ac9701e#diff-4591f6cee344066f126222283295f09b)         | https://github.com/linkedin/pinot/blob/master/pinot-common/src/main/java/com/linkedin/pinot/common/utils/TarGzCompressionUtils.java#L183                                                                                                                                                           |
| AnkiDroid       | Anki-Droid         | [31/5/2018](https://github.com/ankidroid/Anki-Android/commit/7bfffab3982ad76efd06cf7b043d737be0d37f5f#diff-fad1c2723e695df741957168ca8a714f) | https://github.com/ankidroid/Anki-Android/blob/eb540c2fd3aa99a646242c887b9094223ba4a8a1/AnkiDroid/src/main/java/com/ichi2/libanki/Utils.java#L633                                                                                                                                                  |
| ata4            | bspsrc             | [30/5/2018](https://github.com/ata4/bspsrc/commit/379b28237094841b6ede4dc7dacc4bb6d733f265)                                                  | https://github.com/ata4/bspsrc/blob/21e451142738463d999435d36de7353f48daaa15/src/main/java/info/ata4/bsplib/PakFile.java#L60-L89                                                                                                                                                                   |