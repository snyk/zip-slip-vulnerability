# Zip Slip
Zip Slip is a widespread arbitrary file overwrite critical vulnerability discovered and responsibly disclosed by the Snyk Security team ahead of a public disclosure on 5th June 2018. It affects thousands of projects, most notably Apache Maven, Hadoop, Pivotal and many more. The vulnerability has been found in ecosystems, including JavaScript, Ruby, .NET and Go, but is especially prevalent in Java, where there is no central library offering high level processing of archive (e.g. zip) files. The lack of such a library led to vulnerable code snippets being hand crafted and shared among developer communities such as StackOverflow. The vulnerability is exploited using a specially crafted archive that holds path traversal filenames (e.g. ../../evil.sh). The Zip Slip vulnerability can affect numerous archives formats, including tar, jar, war, cpio, apk, rar and 7z.

Zip Slip is a form of directory traversal that can be exploited by extracting files from an archive. The premise of the directory traversal vulnerability is that an attacker can gain access to parts of the file system outside of the target folder in which they should reside. This could happen on both the server side or client side and can lead to sensitive files being written, or overwritten. If an executable is overwritten with a file containing malicious code, the problem can turn into an arbitrary code execution issue. If configuration files or SSH keys are overwritten, it will also be a remote code execution issue.

<TODO: Vulnerable code example>


## Affected Libraries

<TODO:>
<List of affected libraries, some are vulnerable, some are lacking high level api, resulting in vulnerable implementations being reused>


| Vendor        | Product                  | Language   | Confirmed vulnerable | Fixed Version     | CVE              | Fixed     |                                                                                                                                                                                                                                                    |
|---------------|--------------------------|------------|----------------------|-------------------|------------------|-----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| npm library   | [unzipper](https://github.com/ZJONSSON/node-unzipper)                 | JavaScript | YES                  | 0.8.13            | CVE-2018-1002203 | 17/4/2018 | https://github.com/ZJONSSON/node-unzipper/pull/59                                                                                                                                                                                                  |
| npm library   | [adm-zip](https://github.com/cthackers/adm-zip)                  | JavaScript | YES                  | 0.4.9             | CVE-2018-1002204 | 23/4/2018 | https://github.com/cthackers/adm-zip/pull/212                                                                                                                                                                                                      |
| Maven library | [codehaus/plexus-archiver](https://github.com/codehaus-plexus/plexus-archiver) | Java       | YES                  | 3.6.0             | CVE-2018-1002200 | 6/5/2018  | https://github.com/codehaus-plexus/plexus-archiver/pull/87                                                                                                                                                                                         |
| Maven library | [zeroturnaround/zt-zip](https://github.com/zeroturnaround/zt-zip)    | Java       | YES                  | 1.13              | CVE-2018-1002201 | 26/4/2018 | https://github.com/zeroturnaround/zt-zip/blob/master/src/main/java/org/zeroturnaround/zip/ZipUtil.java#L389:26                                                                                                                                     |
| Maven library | [zip4j](https://github.com/supasate/zip4j)                    | Java       | YES                  |                   | CVE-2018-1002202 |           | https://github.com/supasate/zip4j                                                                                                                                                                                                                  |
| Nuget library | [DotNetZip.Semverd](https://github.com/haf/DotNetZip.Semverd)        | .NET       | YES                  | 1.11.0            | CVE-2018-1002205 | 7/5/2018  | https://github.com/haf/DotNetZip.Semverd/compare/master...shana:bugs/relative-paths?expand=1                                                                                                                                                       |
| Nuget library | [SharpCompress](https://github.com/adamhathcock/sharpcompress)            | .NET       | YES                  | 0.21.0            | CVE-2018-1002206 | 2/5/2018  | https://github.com/adamhathcock/sharpcompress/blob/2a5494a804dd3d6f5bec1ec79a52d54ffce610f5/src/SharpCompress/Archives/IArchiveEntryExtensions.cs#L58-L67                                                                                          |
| Go library    | [mholt/archiver](https://github.com/mholt/archiver)           | Go         | YES                  | e4ef56d4          | CVE-2018-1002207 | 17/4/2018 | https://github.com/mholt/archiver/pull/65                                                                                                                                                                                                          |
| Oracle        | [java.util.zip](https://docs.oracle.com/javase/8/docs/api/index.html?java/util/zip/package-summary.html)            | Java       | * No High Level API  | Documentation Fix | N/A              |           |                                                                                                                                                                                                                                                    |
| Apache        | [commons-compress](https://github.com/apache/commons-compress/)         | Java       | * No High Level API  | Documentation Fix | N/A              | 23/4/2018 | https://github.com/apache/commons-compress/commit/97867f6fa3634c77dfafd76c89ecb1087f5cd1ae#diff-1d31ec0d64a29d487ff7377fd8d20cddR359                                                                                                               |
| Nuget library | [SharpZipLib](https://github.com/icsharpcode/SharpZipLib)              | .NET       | * No High Level API  |                   | N/A              |           | https://github.com/icsharpcode/SharpZipLib/blob/master/samples/ICSharpCode.SharpZipLib.Samples/cs/unzipfile/UnZipFile.cs#L37https://github.com/icsharpcode/SharpZipLib/wiki/Zip-Samples#download-and-unpack-a-zip-from-an-ftp-server-with-recovery |
| Ruby gem      | [zip-ruby](https://bitbucket.org/winebarrel/zip-ruby/src/a0bceebd7bf031c8815a8359ba9befe6ead1bedc/zipruby/?at=default                      )                 | Ruby       | * No High Level API  |                   | N/A              |           |                                                                                                                    |
| Ruby gem      | [rubyzip](https://github.com/rubyzip/rubyzip)                  | Ruby       | * No High Level API  |                   | N/A              |           |                                                                                                                                                                                                                  |
| Ruby gem      | [zipruby](https://github.com/fjg/zipruby)                  | Ruby       | * No High Level API  |                   | N/A              |           |                                                                                                                                                                                                                      |
| Go library    | [archive](https://golang.org/pkg/archive/)                  | Go         | * No High Level API  |                   | N/A              |           |                                                                                                                                                                                                                     |

## Affected Projects
| | | |
Name, type (has v snippet, exploitable), Status (removed, CVE)
<PR>





```bash
$ 7z l zip-slip.zip

   Date      Time    Attr         Size   Compressed  Name
------------------- ----- ------------ ------------  ------------------------
2018-04-15 22:04:29 .....           19           19  good.txt
2018-04-15 22:04:42 .....           20           20  ../../../../../../../../tmp/evil.txt
------------------- ----- ------------ ------------  ------------------------
2018-04-15 22:04:42                 39           39  2 files
```
